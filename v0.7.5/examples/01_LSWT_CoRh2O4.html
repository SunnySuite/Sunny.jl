<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>1. Spin wave simulations of CoRh‚ÇÇO‚ÇÑ ¬∑ Documentation</title><meta name="title" content="1. Spin wave simulations of CoRh‚ÇÇO‚ÇÑ ¬∑ Documentation"/><meta property="og:title" content="1. Spin wave simulations of CoRh‚ÇÇO‚ÇÑ ¬∑ Documentation"/><meta property="twitter:title" content="1. Spin wave simulations of CoRh‚ÇÇO‚ÇÑ ¬∑ Documentation"/><meta name="description" content="Documentation for Documentation."/><meta property="og:description" content="Documentation for Documentation."/><meta property="twitter:description" content="Documentation for Documentation."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../index.html"><img class="docs-light-only" src="../assets/logo.svg" alt="Documentation logo"/><img class="docs-dark-only" src="../assets/logo-dark.svg" alt="Documentation logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../index.html">Documentation</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../index.html">Welcome</a></li><li><a class="tocitem" href="../why.html">Why Choose Sunny?</a></li><li><span class="tocitem">Examples</span><ul><li class="is-active"><a class="tocitem" href="01_LSWT_CoRh2O4.html">1. Spin wave simulations of CoRh‚ÇÇO‚ÇÑ</a></li><li><a class="tocitem" href="02_LLD_CoRh2O4.html">2. Landau-Lifshitz dynamics of CoRh‚ÇÇO‚ÇÑ at finite <em>T</em></a></li><li><a class="tocitem" href="03_LSWT_SU3_FeI2.html">3. Multi-flavor spin wave simulations of FeI‚ÇÇ</a></li><li><a class="tocitem" href="04_GSD_FeI2.html">4. Generalized spin dynamics of FeI‚ÇÇ at finite <em>T</em></a></li><li><a class="tocitem" href="05_MC_Ising.html">5. Monte Carlo sampling of the Ising model</a></li><li><a class="tocitem" href="06_CP2_Skyrmions.html">6. Dynamical quench into CP¬≤ skyrmion liquid</a></li><li><a class="tocitem" href="07_Dipole_Dipole.html">7. Long-range dipole interactions</a></li><li><a class="tocitem" href="08_Momentum_Conventions.html">8. Momentum transfer conventions</a></li><li><a class="tocitem" href="09_Disorder_KPM.html">9. Disordered system with KPM</a></li><li><input class="collapse-toggle" id="menuitem-3-10" type="checkbox"/><label class="tocitem" for="menuitem-3-10"><span class="docs-label">SpinW ports</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="spinw/SW01_FM_Heseinberg_chain.html">SW01 - FM Heisenberg chain</a></li><li><a class="tocitem" href="spinw/SW02_AFM_Heisenberg_chain.html">SW02 - AFM Heisenberg chain</a></li><li><a class="tocitem" href="spinw/SW03_Frustrated_chain.html">SW03 - Frustrated J1-J2 chain</a></li><li><a class="tocitem" href="spinw/SW04_Frustrated_square.html">SW04 - Frustrated square lattice</a></li><li><a class="tocitem" href="spinw/SW05_Simple_kagome_FM.html">SW05 - Simple kagome ferromagnet</a></li><li><a class="tocitem" href="spinw/SW06_Complex_kagome_FM.html">SW06 - Complex kagome ferromagnet</a></li><li><a class="tocitem" href="spinw/SW07_k0_kagome_AFM.html">SW07 - k=0 kagome antiferromagnet</a></li><li><a class="tocitem" href="spinw/SW08_sqrt3_kagome_AFM.html">SW08 - ‚àö3√ó‚àö3 kagome antiferromagnet</a></li><li><a class="tocitem" href="spinw/SW09_k0_kagome_AFM_DM.html">SW09 - k=0 kagome AFM and DM</a></li><li><a class="tocitem" href="spinw/SW10_Energy_cut.html">SW10 - Energy cut on square lattice</a></li><li><a class="tocitem" href="spinw/SW11_La2CuO4.html">SW11 - La‚ÇÇCuO‚ÇÑ</a></li><li><a class="tocitem" href="spinw/SW12_Triangular_easy_plane.html">SW12 - Triangular lattice with easy plane</a></li><li><a class="tocitem" href="spinw/SW13_LiNiPO4.html">SW13 - LiNiPO‚ÇÑ</a></li><li><a class="tocitem" href="spinw/SW14_YVO3.html">SW14 - YVO‚ÇÉ</a></li><li><a class="tocitem" href="spinw/SW15_Ba3NbFe3Si2O14.html">SW15 - Ba‚ÇÉNbFe‚ÇÉSi‚ÇÇO‚ÇÅ‚ÇÑ</a></li><li><a class="tocitem" href="spinw/SW18_Distorted_kagome.html">SW18 - Distorted kagome</a></li><li><a class="tocitem" href="spinw/SW19_Different_Ions.html">SW19 - Different magnetic ions</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-11" type="checkbox"/><label class="tocitem" for="menuitem-3-11"><span class="docs-label">Contributed</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="contributed/MgCr2O4-tutorial.html">MgCr2O4 at Finite Temperature</a></li><li><a class="tocitem" href="contributed/entangled_units.html">Entangled Units Formalism</a></li><li><a class="tocitem" href="contributed/kappa_tutorial.html">Enforcing the quantum sum rule with moment renormalization</a></li></ul></li></ul></li><li><a class="tocitem" href="../library.html">Library Reference</a></li><li><span class="tocitem">Notes and Details</span><ul><li><a class="tocitem" href="../structure-factor.html">Structure Factor Conventions</a></li><li><a class="tocitem" href="../renormalization.html">Interaction Renormalization</a></li><li><a class="tocitem" href="../parallelism.html">Parallelizing Calculations</a></li></ul></li><li><a class="tocitem" href="../versions.html">Version History</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="01_LSWT_CoRh2O4.html">1. Spin wave simulations of CoRh‚ÇÇO‚ÇÑ</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="01_LSWT_CoRh2O4.html">1. Spin wave simulations of CoRh‚ÇÇO‚ÇÑ</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SunnySuite/Sunny.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands">ÔÇõ</span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SunnySuite/Sunny.jl/blob/main/examples/01_LSWT_CoRh2O4.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid">ÔÅÑ</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><p>Download this example as <a href="../assets/scripts/01_LSWT_CoRh2O4.jl">Julia file</a> or <a href="../assets/notebooks/01_LSWT_CoRh2O4.ipynb">Jupyter notebook</a>.</p><h1 id="1.-Spin-wave-simulations-of-CoRhO"><a class="docs-heading-anchor" href="#1.-Spin-wave-simulations-of-CoRhO">1. Spin wave simulations of CoRh‚ÇÇO‚ÇÑ</a><a id="1.-Spin-wave-simulations-of-CoRhO-1"></a><a class="docs-heading-anchor-permalink" href="#1.-Spin-wave-simulations-of-CoRhO" title="Permalink"></a></h1><p>This tutorial introduces Sunny through its features for performing conventional spin wave theory calculations. We consider the crystal CoRh‚ÇÇO‚ÇÑ and reproduce the calculations of <a href="https://doi.org/10.1103/PhysRevB.96.064413">Ge et al., Phys. Rev. B <strong>96</strong>, 064413 (2017)</a>.</p><h3 id="Get-Julia-and-Sunny"><a class="docs-heading-anchor" href="#Get-Julia-and-Sunny">Get Julia and Sunny</a><a id="Get-Julia-and-Sunny-1"></a><a class="docs-heading-anchor-permalink" href="#Get-Julia-and-Sunny" title="Permalink"></a></h3><p>Sunny is implemented in Julia, which allows for interactive development (like Python or Matlab) while also providing high numerical efficiency (like C++ or Fortran). New Julia users should begin with our <strong><a href="https://github.com/SunnySuite/Sunny.jl/wiki/Getting-started-with-Julia">Getting Started</a></strong> guide. Sunny requires Julia 1.10 or later.</p><p>From the Julia prompt, load Sunny and also <a href="https://docs.makie.org/">GLMakie</a> for graphics.</p><pre><code class="language-julia hljs">using Sunny, GLMakie</code></pre><p>If these packages are not yet installed, Julia will offer to install them. If executing this tutorial gives an error, you may need to update Sunny and GLMakie from the <a href="https://github.com/SunnySuite/Sunny.jl/wiki/Getting-started-with-Julia#the-built-in-julia-package-manager">built-in package manager</a>.</p><h3 id="Units-system"><a class="docs-heading-anchor" href="#Units-system">Units system</a><a id="Units-system-1"></a><a class="docs-heading-anchor-permalink" href="#Units-system" title="Permalink"></a></h3><p>The <a href="../library.html#Sunny.Units"><code>Units</code></a> object selects reference energy and length scales, and uses these to provide physical constants. For example, <code>units.K</code> returns one kelvin as 0.086 meV, where the Boltzmann constant is implicit.</p><pre><code class="language-julia hljs">units = Units(:meV, :angstrom);</code></pre><h3 id="Crystal-cell"><a class="docs-heading-anchor" href="#Crystal-cell">Crystal cell</a><a id="Crystal-cell-1"></a><a class="docs-heading-anchor-permalink" href="#Crystal-cell" title="Permalink"></a></h3><p>A crystallographic cell may be loaded from a <code>.cif</code> file, or specified from atom positions and types.</p><p>Start by defining the shape of the conventional chemical cell. CoRh‚ÇÇO‚ÇÑ has cubic spacegroup 227 (Fd-3m). Its lattice constants are 8.5 ‚Ñ´, and the cell angles are 90¬∞. With this information, <a href="../library.html#Sunny.lattice_vectors"><code>lattice_vectors</code></a> constructs a 3√ó3 matrix <code>latvecs</code>. Columns of <code>latvecs</code> define the lattice vectors <span>$(ùêö_1, ùêö_2, ùêö_3)$</span> in the global Cartesian coordinate system. Conversely, columns of <code>inv(latvecs)</code> define the global Cartesian axes <span>$(\hat{x}, \hat{y}, \hat{z})$</span> in components of the lattice vectors.</p><pre><code class="language-julia hljs">a = 8.5031 # (√Ö)
latvecs = lattice_vectors(a, a, a, 90, 90, 90)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">3√ó3 StaticArraysCore.SMatrix{3, 3, Float64, 9} with indices SOneTo(3)√óSOneTo(3):
 8.5031  0.0     0.0
 0.0     8.5031  0.0
 0.0     0.0     8.5031</code></pre><p>Construct a <a href="../library.html#Sunny.Crystal"><code>Crystal</code></a> cell from spacegroup 227 in the ITA standard setting. Cobalt atoms belong to Wyckoff 8a, which is the diamond cubic lattice.</p><pre><code class="language-julia hljs">positions = [[1/8, 1/8, 1/8]]
cryst = Crystal(latvecs, positions, 227; types=[&quot;Co&quot;])</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi"><span class="sgr4"><span class="sgr1">Crystal</span></span>
Spacegroup &#39;F d -3 m&#39; (227)
Lattice params a=8.503, b=8.503, c=8.503, Œ±=90¬∞, Œ≤=90¬∞, Œ≥=90¬∞
Cell volume 614.8
Type &#39;Co&#39;, Wyckoff 8a (site sym. &#39;-43m&#39;):
   1. [1/8, 1/8, 1/8]
   2. [5/8, 5/8, 1/8]
   3. [7/8, 3/8, 3/8]
   4. [3/8, 7/8, 3/8]
   5. [5/8, 1/8, 5/8]
   6. [1/8, 5/8, 5/8]
   7. [3/8, 3/8, 7/8]
   8. [7/8, 7/8, 7/8]
</code></pre><p><a href="../library.html#Sunny.view_crystal"><code>view_crystal</code></a> launches an interface for interactive inspection and symmetry analysis.</p><pre><code class="language-julia hljs">view_crystal(cryst)</code></pre><img src="01_LSWT_CoRh2O4-61dcd450.png" alt="Example block output"/><h3 id="Spin-system"><a class="docs-heading-anchor" href="#Spin-system">Spin system</a><a id="Spin-system-1"></a><a class="docs-heading-anchor-permalink" href="#Spin-system" title="Permalink"></a></h3><p>A <a href="../library.html#Sunny.System"><code>System</code></a> will define the spin model. Each cobalt atom carries quantum spin <span>$s = 3/2$</span>, with a <span>$g$</span>-factor of 2. Specify this <a href="../library.html#Sunny.Moment"><code>Moment</code></a> data for cobalt atom 1. By symmetry, the same moment data also applies to cobalt atoms 2, 3, ... 7. The option <code>:dipole</code> indicates a traditional model type, for which quantum spin is modeled as a dipole expectation value.</p><pre><code class="language-julia hljs">sys = System(cryst, [1 =&gt; Moment(s=3/2, g=2)], :dipole)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi"><span class="sgr4"><span class="sgr1">System [Dipole mode]</span></span>
Supercell (1√ó1√ó1)√ó8
Energy per site 0
</code></pre><p>Ge et al. demonstrated that inelastic neutron scattering data for CoRh‚ÇÇO‚ÇÑ is well modeled by antiferromagnetic nearest neighbor exchange, <code>J = 0.63</code> meV. Call <a href="../library.html#Sunny.set_exchange!"><code>set_exchange!</code></a> with the bond that connects atom 1 to atom 3, and has zero displacement between chemical cells. Consistent with the symmetries of spacegroup 227, this interaction will be propagated to all other nearest-neighbor bonds. Calling <a href="../library.html#Sunny.view_crystal"><code>view_crystal</code></a> with <code>sys</code> now shows the antiferromagnetic Heisenberg interactions as blue polkadot spheres.</p><pre><code class="language-julia hljs">J = +0.63 # (meV)
set_exchange!(sys, J, Bond(2, 3, [0, 0, 0]))
view_crystal(sys)</code></pre><img src="01_LSWT_CoRh2O4-4cb18d21.png" alt="Example block output"/><h3 id="Optimizing-spins"><a class="docs-heading-anchor" href="#Optimizing-spins">Optimizing spins</a><a id="Optimizing-spins-1"></a><a class="docs-heading-anchor-permalink" href="#Optimizing-spins" title="Permalink"></a></h3><p>To search for the ground state, call <a href="../library.html#Sunny.randomize_spins!"><code>randomize_spins!</code></a> and <a href="../library.html#Sunny.minimize_energy!"><code>minimize_energy!</code></a> in sequence. For this problem, optimization converges rapidly to the expected N√©el order. See this with <a href="../library.html#Sunny.plot_spins"><code>plot_spins</code></a>, where spins are colored according to their global <span>$z$</span>-component.</p><pre><code class="language-julia hljs">randomize_spins!(sys)
minimize_energy!(sys)
plot_spins(sys; color=[S[3] for S in sys.dipoles])</code></pre><img src="01_LSWT_CoRh2O4-365c87da.png" alt="Example block output"/><p>The diamond lattice is bipartite, allowing each spin to perfectly anti-align with its 4 nearest-neighbors. Each of these 4 bonds contribute <span>$-J s^2$</span> to the total energy. Two sites participate in each bond, so the energy per site is <span>$-2 J s^2$</span>. Check this by calling <a href="../library.html#Sunny.energy_per_site"><code>energy_per_site</code></a>.</p><pre><code class="language-julia hljs">@assert energy_per_site(sys) ‚âà -2J*(3/2)^2</code></pre><h3 id="Reshaping-the-magnetic-cell"><a class="docs-heading-anchor" href="#Reshaping-the-magnetic-cell">Reshaping the magnetic cell</a><a id="Reshaping-the-magnetic-cell-1"></a><a class="docs-heading-anchor-permalink" href="#Reshaping-the-magnetic-cell" title="Permalink"></a></h3><p>The most compact magnetic cell for this N√©el order is the primitive unit cell. Columns of the <a href="../library.html#Sunny.primitive_cell"><code>primitive_cell</code></a> matrix provide the primitive lattice vectors as multiples of the conventional cubic lattice vectors.</p><pre><code class="language-julia hljs">shape = primitive_cell(cryst)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">3√ó3 StaticArraysCore.SMatrix{3, 3, Float64, 9} with indices SOneTo(3)√óSOneTo(3):
 0.0  0.5  0.5
 0.5  0.0  0.5
 0.5  0.5  0.0</code></pre><p>Reduce the magnetic cell size using <a href="../library.html#Sunny.reshape_supercell"><code>reshape_supercell</code></a>. Verify that the energy per site is unchanged after the reshaping the supercell.</p><pre><code class="language-julia hljs">sys_prim = reshape_supercell(sys, shape)
@assert energy_per_site(sys_prim) ‚âà -2J*(3/2)^2</code></pre><p>Plotting <code>sys_prim</code> shows the two spins within the primitive cell, as well as the larger conventional cubic cell for context.</p><pre><code class="language-julia hljs">plot_spins(sys_prim; color=[S[3] for S in sys_prim.dipoles])</code></pre><img src="01_LSWT_CoRh2O4-fb4346ad.png" alt="Example block output"/><h3 id="Spin-wave-theory"><a class="docs-heading-anchor" href="#Spin-wave-theory">Spin wave theory</a><a id="Spin-wave-theory-1"></a><a class="docs-heading-anchor-permalink" href="#Spin-wave-theory" title="Permalink"></a></h3><p>With this primitive cell, we will perform a <a href="../library.html#Sunny.SpinWaveTheory"><code>SpinWaveTheory</code></a> calculation of the structure factor <span>$\mathcal{S}(ùê™,œâ)$</span>. The measurement <a href="../library.html#Sunny.ssf_perp"><code>ssf_perp</code></a> indicates projection of the spin structure factor <span>$\mathcal{S}(ùê™,œâ)$</span> perpendicular to the direction of momentum transfer, as appropriate for unpolarized neutron scattering. The isotropic <a href="../library.html#Sunny.FormFactor"><code>FormFactor</code></a> for Co¬≤‚Å∫ dampens intensities at large <span>$ùê™$</span>.</p><pre><code class="language-julia hljs">formfactors = [1 =&gt; FormFactor(&quot;Co2&quot;)]
measure = ssf_perp(sys_prim; formfactors)
swt = SpinWaveTheory(sys_prim; measure)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi"><span class="sgr4"><span class="sgr1">SpinWaveTheory [Dipole mode]</span></span>
  2 atoms
</code></pre><p>Select <a href="../library.html#Sunny.lorentzian"><code>lorentzian</code></a> broadening with a full-width at half-maximum (FWHM) of 0.8 meV.</p><pre><code class="language-julia hljs">kernel = lorentzian(fwhm=0.8)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Lorentzian kernel, fwhm=0.8</code></pre><p>Define a <a href="../library.html#Sunny.q_space_path"><code>q_space_path</code></a> that connects high-symmetry points in reciprocal space. The <span>$ùê™$</span>-points are given in reciprocal lattice units (RLU) for the <em>original</em> cubic cell. For example, <code>[1/2, 1/2, 0]</code> denotes the sum of the first two reciprocal lattice vectors, <span>$ùêõ_1/2 + ùêõ_2/2$</span>. A total of 500 <span>$ùê™$</span>-points will be sampled along the path.</p><pre><code class="language-julia hljs">qs = [[0, 0, 0], [1/2, 0, 0], [1/2, 1/2, 0], [0, 0, 0]]
path = q_space_path(cryst, qs, 500)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi"><span class="sgr4"><span class="sgr1">QPath (500 samples)</span></span>
  [0, 0, 0] ‚Üí [1/2, 0, 0] ‚Üí [1/2, 1/2, 0] ‚Üí [0, 0, 0]
</code></pre><p>Calculate single-crystal scattering <a href="../library.html#Sunny.intensities"><code>intensities</code></a> along this path, for energies between 0 and 6 meV. Use <a href="../library.html#Sunny.plot_intensities"><code>plot_intensities</code></a> to visualize the result.</p><pre><code class="language-julia hljs">energies = range(0, 6, 300)
res = intensities(swt, path; energies, kernel)
plot_intensities(res; units, title=&quot;CoRh‚ÇÇO‚ÇÑ LSWT&quot;)</code></pre><img src="01_LSWT_CoRh2O4-72102caa.png" alt="Example block output"/><p>Sometimes experimental data is only available as a powder average, i.e., as an average over all possible crystal orientations. Use <a href="../library.html#Sunny.powder_average"><code>powder_average</code></a> to simulate these intensities. Each <span>$ùê™$</span>-magnitude defines a spherical shell in reciprocal space. Consider 200 radii from 0 to 3 inverse angstroms, and collect 2000 random samples per spherical shell. As configured, this calculation completes in about two seconds. Had we used the conventional cubic cell, the calculation would be an order of magnitude slower.</p><pre><code class="language-julia hljs">radii = range(0, 3, 200) # (1/√Ö)
res = powder_average(cryst, radii, 2000) do qs
    intensities(swt, qs; energies, kernel)
end
plot_intensities(res; units, saturation=1.0, title=&quot;CoRh‚ÇÇO‚ÇÑ Powder Average&quot;)</code></pre><img src="01_LSWT_CoRh2O4-9da16a79.png" alt="Example block output"/><p>This result can be compared to experimental neutron scattering data from Fig. 5 of <a href="https://doi.org/10.1103/PhysRevB.96.064413">Ge et al.</a></p><img width="95%" src="https://raw.githubusercontent.com/SunnySuite/Sunny.jl/main/docs/src/assets/CoRh2O4_intensity.jpg"><h3 id="What&#39;s-next?"><a class="docs-heading-anchor" href="#What&#39;s-next?">What&#39;s next?</a><a id="What&#39;s-next?-1"></a><a class="docs-heading-anchor-permalink" href="#What&#39;s-next?" title="Permalink"></a></h3><ul><li>For more spin wave calculations of this type, browse the <a href="spinw/SW01_FM_Heseinberg_chain.html#SW01-FM-Heisenberg-chain">SpinW tutorials ported to Sunny</a>.</li><li>Spin wave theory neglects thermal fluctuations of the magnetic order. The <a href="02_LLD_CoRh2O4.html#2.-Landau-Lifshitz-dynamics-of-CoRhO-at-finite-*T*">next CoRh‚ÇÇO‚ÇÑ tutorial</a> demonstrates how to sample spins in thermal equilibrium, and measure dynamical correlations from the classical spin dynamics.</li><li>Sunny also offers features that go beyond the dipole approximation of a quantum spin via the theory of SU(<em>N</em>) coherent states. This can be especially useful for systems with strong single-ion anisotropy, as demonstrated in the <a href="03_LSWT_SU3_FeI2.html#3.-Multi-flavor-spin-wave-simulations-of-FeI">FeI‚ÇÇ tutorial</a>.</li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../why.html">¬´ Why Choose Sunny?</a><a class="docs-footer-nextpage" href="02_LLD_CoRh2O4.html">2. Landau-Lifshitz dynamics of CoRh‚ÇÇO‚ÇÑ at finite <em>T</em> ¬ª</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Wednesday 22 January 2025 00:12">Wednesday 22 January 2025</span>. Using Julia version 1.10.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
