<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>5. Monte Carlo sampling of the Ising model ¬∑ Sunny documentation</title><meta name="title" content="5. Monte Carlo sampling of the Ising model ¬∑ Sunny documentation"/><meta property="og:title" content="5. Monte Carlo sampling of the Ising model ¬∑ Sunny documentation"/><meta property="twitter:title" content="5. Monte Carlo sampling of the Ising model ¬∑ Sunny documentation"/><meta name="description" content="Documentation for Sunny documentation."/><meta property="og:description" content="Documentation for Sunny documentation."/><meta property="twitter:description" content="Documentation for Sunny documentation."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../index.html"><img class="docs-light-only" src="../assets/logo.svg" alt="Sunny documentation logo"/><img class="docs-dark-only" src="../assets/logo-dark.svg" alt="Sunny documentation logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../index.html">Sunny documentation</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../index.html">Overview</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="01_LSWT_SU3_FeI2.html">1. Multi-flavor spin wave simulations of FeI‚ÇÇ (Showcase)</a></li><li><a class="tocitem" href="02_LSWT_CoRh2O4.html">2. Spin wave simulations of CoRh‚ÇÇO‚ÇÑ</a></li><li><a class="tocitem" href="03_LLD_CoRh2O4.html">3. Landau-Lifshitz dynamics of CoRh‚ÇÇO‚ÇÑ at finite <em>T</em></a></li><li><a class="tocitem" href="04_GSD_FeI2.html">4. Generalized spin dynamics of FeI‚ÇÇ at finite <em>T</em></a></li><li class="is-active"><a class="tocitem" href="05_MC_Ising.html">5. Monte Carlo sampling of the Ising model</a></li><li><a class="tocitem" href="06_CP2_Skyrmions.html">6. Dynamical quench into CP¬≤ skyrmion liquid</a></li><li><a class="tocitem" href="07_Dipole_Dipole.html">7. Long-range dipole interactions</a></li><li><a class="tocitem" href="08_Momentum_Conventions.html">8. Momentum transfer conventions</a></li><li><input class="collapse-toggle" id="menuitem-2-9" type="checkbox"/><label class="tocitem" for="menuitem-2-9"><span class="docs-label">SpinW tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="spinw/SW08_Kagome_AFM.html">SW8 - Kagome Antiferromagnet</a></li><li><a class="tocitem" href="spinw/SW15_Ba3NbFe3Si2O14.html">SW15 - Ba‚ÇÉNbFe‚ÇÉSi‚ÇÇO‚ÇÅ‚ÇÑ</a></li><li><a class="tocitem" href="spinw/SW18_Distorted_kagome.html">SW18 - Distorted kagome</a></li><li><a class="tocitem" href="spinw/SW19_Different_Ions.html">SW19 - Different magnetic ions</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-10" type="checkbox"/><label class="tocitem" for="menuitem-2-10"><span class="docs-label">Contributed</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="contributed/MgCr2O4-tutorial.html">MgCr2O4 at Finite Temperature</a></li><li><a class="tocitem" href="contributed/kappa_tutorial.html">Enforcing the quantum sum rule with moment renormalization</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-11" type="checkbox"/><label class="tocitem" for="menuitem-2-11"><span class="docs-label">Advanced</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../parallelism.html">Parallelizing Calculations</a></li><li><a class="tocitem" href="../writevtk.html">ParaView Rendering</a></li></ul></li></ul></li><li><span class="tocitem">Modeling Guides</span><ul><li><a class="tocitem" href="../structure-factor.html">Structure Factor Calculations</a></li><li><a class="tocitem" href="../renormalization.html">Interaction Strength Renormalization</a></li></ul></li><li><a class="tocitem" href="../library.html">Library API</a></li><li><a class="tocitem" href="../versions.html">Version History</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="05_MC_Ising.html">5. Monte Carlo sampling of the Ising model</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="05_MC_Ising.html">5. Monte Carlo sampling of the Ising model</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SunnySuite/Sunny.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands">ÔÇõ</span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SunnySuite/Sunny.jl/blob/main/examples/05_MC_Ising.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid">ÔÅÑ</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><p>Download this example as <a href="../assets/notebooks/05_MC_Ising.ipynb">Jupyter notebook</a> or <a href="../assets/scripts/05_MC_Ising.jl">Julia script</a>.</p><h1 id="5.-Monte-Carlo-sampling-of-the-Ising-model"><a class="docs-heading-anchor" href="#5.-Monte-Carlo-sampling-of-the-Ising-model">5. Monte Carlo sampling of the Ising model</a><a id="5.-Monte-Carlo-sampling-of-the-Ising-model-1"></a><a class="docs-heading-anchor-permalink" href="#5.-Monte-Carlo-sampling-of-the-Ising-model" title="Permalink"></a></h1><p>This tutorial illustrates simulation of the classical 2D Ising model.</p><pre><code class="language-julia hljs">using Sunny, GLMakie</code></pre><p>Sunny expects a 3D <a href="../library.html#Sunny.Crystal"><code>Crystal</code></a> unit cell. To model a square lattice, we create an orthogonal unit cell where the <span>$z$</span>-spacing is distinct from the <span>$x$</span> and <span>$y$</span> spacing.</p><pre><code class="language-julia hljs">a = 1
latvecs = lattice_vectors(a,a,10a,90,90,90)
crystal = Crystal(latvecs, [[0,0,0]])</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi"><span class="sgr4"><span class="sgr1">Crystal</span></span>
Spacegroup &#39;P 4/m m m&#39; (123)
Lattice params a=1, b=1, c=10, Œ±=90¬∞, Œ≤=90¬∞, Œ≥=90¬∞
Cell volume 10
Wyckoff 1a (point group &#39;4/mmm&#39;):
   1. [0, 0, 0]
</code></pre><p>Create a <a href="../library.html#Sunny.System-Tuple{Crystal, Tuple{Int64, Int64, Int64}, Vector{SpinInfo}, Symbol}"><code>System</code></a> of spins with linear size <code>L</code> in the <span>$x$</span> and <span>$y$</span> directions, and only one layer in the <span>$z$</span> direction. The option <code>:dipole</code> means that the system will store Heisenberg spins, as opposed to SU(<span>$N$</span>) coherent states. Polarize the initial spin configuration using <a href="../library.html#Sunny.polarize_spins!-Union{Tuple{N}, Tuple{System{N}, Any}} where N"><code>polarize_spins!</code></a>. Following the Ising convention, we will restrict these spins to the <span>$z$</span>-axis and give them magnitude <span>$S=1$</span>.</p><p>By default, Sunny uses physical units, e.g. magnetic field in tesla. Here we specify an alternative <a href="../library.html#Sunny.Units"><code>Units</code></a> system, so that the Zeeman coupling between the spin dipole <span>$ùê¨$</span> and an external field <span>$ùêÅ$</span> has the dimensionless form <span>$-ùêÅ‚ãÖùê¨$</span>.</p><pre><code class="language-julia hljs">L = 128
sys = System(crystal, (L,L,1), [SpinInfo(1, S=1, g=1)], :dipole, units=Units.theory, seed=0)
polarize_spins!(sys, (0,0,1))</code></pre><p>Use <a href="../library.html#Sunny.set_exchange!-Union{Tuple{N}, Tuple{System{N}, Any, Bond}} where N"><code>set_exchange!</code></a> to include a ferromagnetic Heisenberg interaction along nearest-neighbor bonds. The <a href="../library.html#Sunny.Bond"><code>Bond</code></a> below connects two spins displaced by one lattice constant in the <span>$x$</span>-direction. This interaction will be propagated to all nearest-neighbors bonds in the system, consistent with the symmetries of the square lattice.</p><pre><code class="language-julia hljs">set_exchange!(sys, -1.0, Bond(1,1,(1,0,0)))</code></pre><p>If an external field is desired, it can be set using <a href="../library.html#Sunny.set_external_field!-Tuple{System, Any}"><code>set_external_field!</code></a>.</p><pre><code class="language-julia hljs">B = 0
set_external_field!(sys, (0,0,B))</code></pre><p>The critical temperature for the Ising model is known analytically.</p><pre><code class="language-julia hljs">Tc = 2/log(1+‚àö2)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2.269185314213022</code></pre><p>Use a <a href="../library.html#Sunny.LocalSampler"><code>LocalSampler</code></a> to perform <code>nsweeps</code> Monte Carlo sweeps. A sweep consists of, on average, one trial update per spin in the system. Each proposed update is accepted or rejected according to the Metropolis acceptance probability. As its name suggests, the <a href="../library.html#Sunny.propose_flip-Union{Tuple{N}, Tuple{System{N}, Any}} where N"><code>propose_flip</code></a> function will only propose pure spin flips, <span>$ùê¨ \rightarrow -ùê¨$</span>.</p><pre><code class="language-julia hljs">nsweeps = 4000
sampler = LocalSampler(kT=Tc, propose=propose_flip)
for i in 1:nsweeps
    step!(sys, sampler)
end</code></pre><p>Plot the Ising spins by extracting the <span>$z$</span>-component of the dipoles</p><pre><code class="language-julia hljs">heatmap(reshape([s.z for s in sys.dipoles], (L,L)))</code></pre><img src="05_MC_Ising-8806c2ce.png" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="04_GSD_FeI2.html">¬´ 4. Generalized spin dynamics of FeI‚ÇÇ at finite <em>T</em></a><a class="docs-footer-nextpage" href="06_CP2_Skyrmions.html">6. Dynamical quench into CP¬≤ skyrmion liquid ¬ª</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.4.1 on <span class="colophon-date" title="Tuesday 18 June 2024 23:16">Tuesday 18 June 2024</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
