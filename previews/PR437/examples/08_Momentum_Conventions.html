<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>8. Momentum transfer conventions · Sunny.jl</title><meta name="title" content="8. Momentum transfer conventions · Sunny.jl"/><meta property="og:title" content="8. Momentum transfer conventions · Sunny.jl"/><meta property="twitter:title" content="8. Momentum transfer conventions · Sunny.jl"/><meta name="description" content="Documentation for Sunny.jl."/><meta property="og:description" content="Documentation for Sunny.jl."/><meta property="twitter:description" content="Documentation for Sunny.jl."/><meta property="og:url" content="https://sunnysuite.github.io/Sunny.jl/stable/examples/08_Momentum_Conventions.html"/><meta property="twitter:url" content="https://sunnysuite.github.io/Sunny.jl/stable/examples/08_Momentum_Conventions.html"/><link rel="canonical" href="https://sunnysuite.github.io/Sunny.jl/stable/examples/08_Momentum_Conventions.html"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../index.html"><img class="docs-light-only" src="../assets/logo.svg" alt="Sunny.jl logo"/><img class="docs-dark-only" src="../assets/logo-dark.svg" alt="Sunny.jl logo"/></a><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../index.html">Welcome</a></li><li><a class="tocitem" href="../why.html">Why Choose Sunny?</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="01_LSWT_CoRh2O4.html">1. Spin wave simulations of CoRh₂O₄</a></li><li><a class="tocitem" href="02_LLD_CoRh2O4.html">2. Landau-Lifshitz dynamics of CoRh₂O₄ at finite <em>T</em></a></li><li><a class="tocitem" href="03_LSWT_SU3_FeI2.html">3. Multi-flavor spin wave simulations of FeI₂</a></li><li><a class="tocitem" href="04_GSD_FeI2.html">4. Generalized spin dynamics of FeI₂ at finite <em>T</em></a></li><li><a class="tocitem" href="05_MC_Ising.html">5. Monte Carlo sampling of the Ising model</a></li><li><a class="tocitem" href="06_CP2_Skyrmions.html">6. Dynamical quench into CP² skyrmion liquid</a></li><li><a class="tocitem" href="07_Dipole_Dipole.html">7. Long-range dipole interactions</a></li><li class="is-active"><a class="tocitem" href="08_Momentum_Conventions.html">8. Momentum transfer conventions</a></li><li><a class="tocitem" href="09_Disorder_KPM.html">9. Disordered systems</a></li><li><input class="collapse-toggle" id="menuitem-3-10" type="checkbox"/><label class="tocitem" for="menuitem-3-10"><span class="docs-label">SpinW ports</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="spinw/SW01_FM_Heseinberg_chain.html">SW01 - FM Heisenberg chain</a></li><li><a class="tocitem" href="spinw/SW02_AFM_Heisenberg_chain.html">SW02 - AFM Heisenberg chain</a></li><li><a class="tocitem" href="spinw/SW03_Frustrated_chain.html">SW03 - Frustrated J1-J2 chain</a></li><li><a class="tocitem" href="spinw/SW04_Frustrated_square.html">SW04 - Frustrated square lattice</a></li><li><a class="tocitem" href="spinw/SW05_Simple_kagome_FM.html">SW05 - Simple kagome ferromagnet</a></li><li><a class="tocitem" href="spinw/SW06_Complex_kagome_FM.html">SW06 - Complex kagome ferromagnet</a></li><li><a class="tocitem" href="spinw/SW07_k0_kagome_AFM.html">SW07 - k=0 kagome antiferromagnet</a></li><li><a class="tocitem" href="spinw/SW08_sqrt3_kagome_AFM.html">SW08 - √3×√3 kagome antiferromagnet</a></li><li><a class="tocitem" href="spinw/SW09_k0_kagome_AFM_DM.html">SW09 - k=0 kagome AFM and DM</a></li><li><a class="tocitem" href="spinw/SW10_Energy_cut.html">SW10 - Energy cut on square lattice</a></li><li><a class="tocitem" href="spinw/SW11_La2CuO4.html">SW11 - La₂CuO₄</a></li><li><a class="tocitem" href="spinw/SW12_Triangular_easy_plane.html">SW12 - Triangular lattice with easy plane</a></li><li><a class="tocitem" href="spinw/SW13_LiNiPO4.html">SW13 - LiNiPO₄</a></li><li><a class="tocitem" href="spinw/SW14_YVO3.html">SW14 - YVO₃</a></li><li><a class="tocitem" href="spinw/SW15_Ba3NbFe3Si2O14.html">SW15 - Ba₃NbFe₃Si₂O₁₄</a></li><li><a class="tocitem" href="spinw/SW18_Distorted_kagome.html">SW18 - Distorted kagome</a></li><li><a class="tocitem" href="spinw/SW19_Different_Ions.html">SW19 - Different magnetic ions</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-11" type="checkbox"/><label class="tocitem" for="menuitem-3-11"><span class="docs-label">Contributed</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="contributed/MgCr2O4-tutorial.html">MgCr2O4 at Finite Temperature</a></li><li><a class="tocitem" href="contributed/entangled_units.html">Entangled Units Formalism</a></li><li><a class="tocitem" href="contributed/kappa_tutorial.html">Enforcing the quantum sum rule with moment renormalization</a></li></ul></li></ul></li><li><a class="tocitem" href="../library.html">Library Reference</a></li><li><span class="tocitem">Notes and Details</span><ul><li><a class="tocitem" href="../structure-factor.html">Structure Factor Conventions</a></li><li><a class="tocitem" href="../renormalization.html">Interaction Renormalization</a></li><li><a class="tocitem" href="../parallelism.html">Parallelizing Calculations</a></li></ul></li><li><a class="tocitem" href="../versions.html">Version History</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="08_Momentum_Conventions.html">8. Momentum transfer conventions</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="08_Momentum_Conventions.html">8. Momentum transfer conventions</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SunnySuite/Sunny.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><p>Download this example as <a href="../assets/scripts/08_Momentum_Conventions.jl">Julia file</a> or <a href="../assets/notebooks/08_Momentum_Conventions.ipynb">Jupyter notebook</a>.</p><h1 id="8.-Momentum-transfer-conventions"><a class="docs-heading-anchor" href="#8.-Momentum-transfer-conventions">8. Momentum transfer conventions</a><a id="8.-Momentum-transfer-conventions-1"></a><a class="docs-heading-anchor-permalink" href="#8.-Momentum-transfer-conventions" title="Permalink"></a></h1><p>Sunny defines the dynamical structure factor following conventions as in <a href="https://doi.org/10.1017/CBO9781139107808">Squire</a> and <a href="https://groups.physics.ox.ac.uk/Boothroyd/PNS/">Boothroyd</a>,</p><p class="math-container">\[\mathcal{S}^{αβ}(𝐪, ω) ≡ \frac{1}{2π} \int_{-∞}^{∞} e^{-iωt} ⟨\hat{M}^{†α}_𝐪(0) \hat{M}^β_𝐪(t)⟩ dt.\]</p><p>The momentum-space dipole operator <span>$\hat{𝐌}_𝐪$</span> is obtained from the real-space density <span>$\hat{𝐌}(𝐫)$</span> using the Fourier transform convention,</p><p class="math-container">\[\hat{𝐌}_𝐪 ≡ \int_V e^{+ i 𝐪⋅𝐫} \hat{𝐌}(𝐫) d𝐫.\]</p><p>With appropriate contraction of spin components, <span>$\mathcal{S}^{αβ}(𝐪, ω)$</span> directly relates to the neutron scattering cross-section. Here, <span>$𝐪$</span> and <span>$ω$</span> represent momentum and energy transfer <em>to</em> the sample. Sunny will report the structure factor as an intensive quantity by dividing by the number of chemical cells in the macroscopic sample. Full details are given in the documentation page <a href="../structure-factor.html#Structure-Factor-Conventions">Structure Factor Conventions</a>.</p><p>If the spin Hamiltonian lacks inversion symmetry, intensities at <span>$±𝐪$</span> may be inequivalent. A simple example is the 1D chain with competing Ising and Dzyaloshinskii–Moriya couplings. Sunny calculations on this model can be compared to those of other codes. For example, <a href="https://spinw.org/">SpinW</a> employs the opposite sign convention for the momentum transfer <span>$𝐪$</span>.</p><h3 id="1D-model-lacking-reflection-symmetry"><a class="docs-heading-anchor" href="#1D-model-lacking-reflection-symmetry">1D model lacking reflection symmetry</a><a id="1D-model-lacking-reflection-symmetry-1"></a><a class="docs-heading-anchor-permalink" href="#1D-model-lacking-reflection-symmetry" title="Permalink"></a></h3><pre><code class="language-julia hljs">using Sunny, GLMakie</code></pre><p>Create a <a href="../library.html#Sunny.Crystal"><code>Crystal</code></a> with spacegroup P1 to effectively disable all symmetry analysis. This avoids any symmetry-imposed constraints on the couplings. Because all bonds are treated as symmetry-inequivalent, each coupling must be specified independently; there is no automatic propagation to &quot;equivalent&quot; bonds.</p><pre><code class="language-julia hljs">latvecs = lattice_vectors(1, 1, 1, 90, 90, 90)
cryst = Crystal(latvecs, [[0, 0, 0]], &quot;P1&quot;)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi"><span class="sgr4"><span class="sgr1">Crystal</span></span>
Spacegroup &#39;P 1&#39; (1)
Lattice params a=1, b=1, c=1, α=90°, β=90°, γ=90°
Cell volume 1
Wyckoff 1a (site sym. &#39;1&#39;):
   1. [0, 0, 0]
</code></pre><p>Include DM and Ising couplings between nearest neighbors on a chain. Letting <span>$j$</span> denote the site position along axis <span>$𝐚_3$</span>, the full Hamiltonian is</p><p class="math-container">\[ℋ = 𝐃 ⋅ ∑_j 𝐒_j × 𝐒_{j+1} - J ∑_j ∑_j S^z_j S^z_{j+1},\]</p><p>with <a href="../library.html#Sunny.dmvec"><code>dmvec</code></a> <span>$𝐃 = D ẑ$</span>.</p><pre><code class="language-julia hljs">s = 3/2
sys = System(cryst, [1 =&gt; Moment(; s, g=2)], :dipole)
J = 1.0
D = 0.2
z = [0, 0, 1]
set_exchange!(sys, dmvec(D * z) - J * z * z&#39;, Bond(1, 1, [0, 0, 1]))</code></pre><p>The relatively large Ising coupling favors one of two polarized states, <span>$±ẑ$</span>. Use <a href="../library.html#Sunny.polarize_spins!"><code>polarize_spins!</code></a> to align <span>$𝐒$</span> with <span>$+ẑ$</span>. This polarization could also be realized via an applied <span>$𝐁$</span> field in the <em>opposite</em> direction, as documented in <a href="../library.html#Sunny.set_field!"><code>set_field!</code></a>.</p><pre><code class="language-julia hljs">polarize_spins!(sys, [0, 0, 1])
@assert energy(sys) ≈ - s^2
plot_spins(sys)</code></pre><img src="08_Momentum_Conventions-81e4a216.png" alt="Example block output"/><h3 id="Intensities-from-linear-spin-wave-theory"><a class="docs-heading-anchor" href="#Intensities-from-linear-spin-wave-theory">Intensities from linear spin wave theory</a><a id="Intensities-from-linear-spin-wave-theory-1"></a><a class="docs-heading-anchor-permalink" href="#Intensities-from-linear-spin-wave-theory" title="Permalink"></a></h3><p>The <a href="../library.html#Sunny.SpinWaveTheory"><code>SpinWaveTheory</code></a> calculation shows a single band with dispersion <span>$ϵ(𝐪) = 2 s [J ± D \sin(2πq_3)]$</span> for the polarization state <span>$𝐒 = ± s ẑ$</span>. There is a clear dependence on the sign of <span>$q_3$</span>.</p><pre><code class="language-julia hljs">path = q_space_path(cryst, [[0, 0, -1/2], [0, 0, 0], [0, 0, +1/2]], 400)
swt = SpinWaveTheory(sys; measure=ssf_trace(sys))
res = intensities_bands(swt, path)
plot_intensities(res; ylims=(0, 5))</code></pre><img src="08_Momentum_Conventions-850cbff6.png" alt="Example block output"/><h3 id="Intensities-from-classical-spin-dynamics"><a class="docs-heading-anchor" href="#Intensities-from-classical-spin-dynamics">Intensities from classical spin dynamics</a><a id="Intensities-from-classical-spin-dynamics-1"></a><a class="docs-heading-anchor-permalink" href="#Intensities-from-classical-spin-dynamics" title="Permalink"></a></h3><p>Classical dynamics at low temperatures produces, in principle, the same excitation spectrum. Here, finite-size effects will limit <span>$𝐪$</span>-space resolution. Use <a href="../library.html#Sunny.resize_supercell"><code>resize_supercell</code></a> to study a chain of 32 sites.</p><pre><code class="language-julia hljs">sys2 = resize_supercell(sys, (1, 1, 32))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi"><span class="sgr4"><span class="sgr1">System [Dipole mode]</span></span>
Supercell (1×1×32)×1
Energy per site -9/4
</code></pre><p>Use <a href="../library.html#Sunny.Langevin"><code>Langevin</code></a> dynamics to sample from the classical Boltzmann distribution at a relatively low temperature, <span>$k_B T / J = 0.03$</span></p><pre><code class="language-julia hljs">dt = 0.03 / J
kT = 0.03 * J
damping = 0.1
langevin = Langevin(dt; kT, damping)
suggest_timestep(sys2, langevin; tol=1e-2)
for _ in 1:10_000
    step!(sys, langevin)
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Consider dt ≈ 0.03296 for this spin configuration at tol = 0.01000. Current value is dt = 0.03000.</code></pre><p>Use <a href="../library.html#Sunny.SampledCorrelations"><code>SampledCorrelations</code></a> to collect statistics from classical spin dynamic trajectories.</p><pre><code class="language-julia hljs">sc = SampledCorrelations(sys2; dt, energies=range(0, 5, 100), measure=ssf_trace(sys2))
add_sample!(sc, sys2)
nsamples = 100
for _ in 1:nsamples
    for _ in 1:1000
        step!(sys2, langevin)
    end
    add_sample!(sc, sys2)
end</code></pre><p>In the limit <span>$T → 0$</span>, the <a href="../library.html#Sunny.intensities"><code>intensities</code></a> match linear spin wave theory up to finite-size effects and statistical error. Additionally, the classical dynamics calculation shows the elastic peak at <span>$𝐪 = [0,0,0]$</span>, associated with the ferromagnetic ground state.</p><pre><code class="language-julia hljs">res2 = intensities(sc, path; energies=:available, kT)
plot_intensities(res2)</code></pre><img src="08_Momentum_Conventions-942a51a3.png" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="07_Dipole_Dipole.html">« 7. Long-range dipole interactions</a><a class="docs-footer-nextpage" href="09_Disorder_KPM.html">9. Disordered systems »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Monday 20 October 2025 14:31">Monday 20 October 2025</span>. Using Julia version 1.10.10.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
