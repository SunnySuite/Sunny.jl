<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Interaction Renormalization · Documentation</title><meta name="title" content="Interaction Renormalization · Documentation"/><meta property="og:title" content="Interaction Renormalization · Documentation"/><meta property="twitter:title" content="Interaction Renormalization · Documentation"/><meta name="description" content="Documentation for Documentation."/><meta property="og:description" content="Documentation for Documentation."/><meta property="twitter:description" content="Documentation for Documentation."/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="index.html"><img class="docs-light-only" src="assets/logo.svg" alt="Documentation logo"/><img class="docs-dark-only" src="assets/logo-dark.svg" alt="Documentation logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="index.html">Documentation</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="index.html">Welcome</a></li><li><a class="tocitem" href="why.html">Why Choose Sunny?</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="examples/01_LSWT_CoRh2O4.html">1. Spin wave simulations of CoRh₂O₄</a></li><li><a class="tocitem" href="examples/02_LLD_CoRh2O4.html">2. Landau-Lifshitz dynamics of CoRh₂O₄ at finite <em>T</em></a></li><li><a class="tocitem" href="examples/03_LSWT_SU3_FeI2.html">3. Multi-flavor spin wave simulations of FeI₂</a></li><li><a class="tocitem" href="examples/04_GSD_FeI2.html">4. Generalized spin dynamics of FeI₂ at finite <em>T</em></a></li><li><a class="tocitem" href="examples/05_MC_Ising.html">5. Monte Carlo sampling of the Ising model</a></li><li><a class="tocitem" href="examples/06_CP2_Skyrmions.html">6. Dynamical quench into CP² skyrmion liquid</a></li><li><a class="tocitem" href="examples/07_Dipole_Dipole.html">7. Long-range dipole interactions</a></li><li><a class="tocitem" href="examples/08_Momentum_Conventions.html">8. Momentum transfer conventions</a></li><li><a class="tocitem" href="examples/09_Disorder_KPM.html">9. Disordered system with KPM</a></li><li><input class="collapse-toggle" id="menuitem-3-10" type="checkbox"/><label class="tocitem" for="menuitem-3-10"><span class="docs-label">SpinW ports</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="examples/spinw/SW01_FM_Heseinberg_chain.html">SW01 - FM Heisenberg chain</a></li><li><a class="tocitem" href="examples/spinw/SW02_AFM_Heisenberg_chain.html">SW02 - AFM Heisenberg chain</a></li><li><a class="tocitem" href="examples/spinw/SW03_Frustrated_chain.html">SW03 - Frustrated J1-J2 chain</a></li><li><a class="tocitem" href="examples/spinw/SW04_Frustrated_square.html">SW04 - Frustrated square lattice</a></li><li><a class="tocitem" href="examples/spinw/SW05_Simple_kagome_FM.html">SW05 - Simple kagome ferromagnet</a></li><li><a class="tocitem" href="examples/spinw/SW06_Complex_kagome_FM.html">SW06 - Complex kagome ferromagnet</a></li><li><a class="tocitem" href="examples/spinw/SW07_k0_kagome_AFM.html">SW07 - k=0 kagome antiferromagnet</a></li><li><a class="tocitem" href="examples/spinw/SW08_sqrt3_kagome_AFM.html">SW08 - √3×√3 kagome antiferromagnet</a></li><li><a class="tocitem" href="examples/spinw/SW09_k0_kagome_AFM_DM.html">SW09 - k=0 kagome AFM and DM</a></li><li><a class="tocitem" href="examples/spinw/SW10_Energy_cut.html">SW10 - Energy cut on square lattice</a></li><li><a class="tocitem" href="examples/spinw/SW11_La2CuO4.html">SW11 - La₂CuO₄</a></li><li><a class="tocitem" href="examples/spinw/SW12_Triangular_easy_plane.html">SW12 - Triangular lattice with easy plane</a></li><li><a class="tocitem" href="examples/spinw/SW13_LiNiPO4.html">SW13 - LiNiPO₄</a></li><li><a class="tocitem" href="examples/spinw/SW14_YVO3.html">SW14 - YVO₃</a></li><li><a class="tocitem" href="examples/spinw/SW15_Ba3NbFe3Si2O14.html">SW15 - Ba₃NbFe₃Si₂O₁₄</a></li><li><a class="tocitem" href="examples/spinw/SW18_Distorted_kagome.html">SW18 - Distorted kagome</a></li><li><a class="tocitem" href="examples/spinw/SW19_Different_Ions.html">SW19 - Different magnetic ions</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-11" type="checkbox"/><label class="tocitem" for="menuitem-3-11"><span class="docs-label">Contributed</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="examples/contributed/MgCr2O4-tutorial.html">MgCr2O4 at Finite Temperature</a></li><li><a class="tocitem" href="examples/contributed/kappa_tutorial.html">Enforcing the quantum sum rule with moment renormalization</a></li></ul></li></ul></li><li><a class="tocitem" href="library.html">Library Reference</a></li><li><span class="tocitem">Notes and Details</span><ul><li><a class="tocitem" href="structure-factor.html">Structure Factor Conventions</a></li><li class="is-active"><a class="tocitem" href="renormalization.html">Interaction Renormalization</a><ul class="internal"><li><a class="tocitem" href="#Local-operators"><span>Local operators</span></a></li><li><a class="tocitem" href="#Renormalization-procedure-for-:dipole-mode"><span>Renormalization procedure for <code>:dipole</code> mode</span></a></li><li><a class="tocitem" href="#Use-:dipole_uncorrected-mode-to-disable-renormalization"><span>Use <code>:dipole_uncorrected</code> mode to disable renormalization</span></a></li><li><a class="tocitem" href="#Definition-of-Stevens-operators"><span>Definition of Stevens operators</span></a></li></ul></li><li><a class="tocitem" href="parallelism.html">Parallelizing Calculations</a></li></ul></li><li><a class="tocitem" href="versions.html">Version History</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Notes and Details</a></li><li class="is-active"><a href="renormalization.html">Interaction Renormalization</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="renormalization.html">Interaction Renormalization</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SunnySuite/Sunny.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SunnySuite/Sunny.jl/blob/main/docs/src/renormalization.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Interaction-Renormalization"><a class="docs-heading-anchor" href="#Interaction-Renormalization">Interaction Renormalization</a><a id="Interaction-Renormalization-1"></a><a class="docs-heading-anchor-permalink" href="#Interaction-Renormalization" title="Permalink"></a></h1><p>A unique feature of Sunny is its support for building classical models where quantum spin is represented as an <span>$N$</span>-level system, rather than just an expected dipole. This generalization can be important when modeling quantum spin Hamiltonians that include, e.g., a single-ion anisotropy, or a biquadratic coupling between sites. Sunny also supports constraining quantum spin to the space of pure dipoles; in this case, Sunny will automatically perform an interaction strength renormalization that enhances accuracy.</p><h2 id="Local-operators"><a class="docs-heading-anchor" href="#Local-operators">Local operators</a><a id="Local-operators-1"></a><a class="docs-heading-anchor-permalink" href="#Local-operators" title="Permalink"></a></h2><p>A quantum spin-<span>$s$</span> state has <span>$N = 2s + 1$</span> levels. Each local spin operator <span>$\hat{S}^{\{x,y,z\}}$</span> is faithfully represented as an <span>$N×N$</span> matrix. These matrices can be accessed using <a href="library.html#Sunny.spin_matrices"><code>spin_matrices</code></a> for a given label <span>$s$</span>. For example, the Pauli matrices are associated with <span>$s = 1/2$</span>.</p><p>When <span>$s &gt; 1/2$</span>, it is possible to construct multipole moments beyond the spin-dipole. For example,</p><pre><code class="language-julia hljs">S = spin_matrices(3/2)
@assert S[3] ≈ diagm([3/2, 1/2, -1/2, -3/2])
@assert S[3]^2 ≈ diagm([9/4, 1/4, 1/4, 9/4])</code></pre><p>If the operator <code>-S[3]^2</code> is passed to <a href="library.html#Sunny.set_onsite_coupling!"><code>set_onsite_coupling!</code></a>, it would set an easy-axis anisotropy in the <span>$\hat{z}$</span> direction.</p><p>Any Hermitian operator can be expanded in the basis of Stevens operators <span>$\hat{\mathcal{O}}_{k,q}$</span> up to a constant shift. To see this expansion, use <a href="library.html#Sunny.print_stevens_expansion"><code>print_stevens_expansion</code></a>:</p><pre><code class="language-julia hljs">print_stevens_expansion((S[1]^2 + S[2]^2)) # Prints -(1/3)𝒪₂₀ + 5/2</code></pre><p>Alternatively, the same operator could have been constructed directly from <a href="library.html#Sunny.stevens_matrices"><code>stevens_matrices</code></a>:</p><pre><code class="language-julia hljs">O = stevens_matrices(3/2)
@assert S[1]^2 + S[2]^2 ≈ -O[2, 0]/3 + (5/2)*I</code></pre><p>The Stevens operators <span>$\mathcal{O}_{k, q}$</span> are <a href="renormalization.html#Definition-of-Stevens-operators">defined below</a> as <span>$k$</span>th order polynomials of the spin operators.</p><h2 id="Renormalization-procedure-for-:dipole-mode"><a class="docs-heading-anchor" href="#Renormalization-procedure-for-:dipole-mode">Renormalization procedure for <code>:dipole</code> mode</a><a id="Renormalization-procedure-for-:dipole-mode-1"></a><a class="docs-heading-anchor-permalink" href="#Renormalization-procedure-for-:dipole-mode" title="Permalink"></a></h2><p>Sunny will typically operate in one of two modes: <code>:SUN</code> or <code>:dipole</code>. The former faithfully represents quantum spin as an SU(<em>N</em>) coherent-state which, for our purposes, is an <span>$N$</span>-component complex vector. In contrast, <code>:dipole</code> mode constrains the coherent-state to the space of pure dipoles. Here, Sunny will automatically renormalize the magnitude of each Stevens expectation value to achieve maximal consistency with <code>:SUN</code> mode. This procedure was derived in <a href="https://arxiv.org/abs/2304.03874">D. Dahlbom et al., [arXiv:2304.03874]</a>.</p><p>By way of illustration, consider a quantum operator <span>$\hat{\mathcal{H}}_{\mathrm{local}}$</span> giving a single-ion anisotropy for one site. It can be expanded in <a href="renormalization.html#Definition-of-Stevens-operators">Stevens operators</a>,</p><p class="math-container">\[\hat{\mathcal H}_{\mathrm{local}} = \sum_{k, q} A_{k,q} \hat{\mathcal{O}}_{k,q},\]</p><p>for some coefficients <span>$A_{k,q}$</span>.</p><p>In <code>:SUN</code> mode, Sunny will faithfully represent <span>$\hat{\mathcal H}_{\mathrm{local}}$</span> as an <span>$N×N$</span> matrix. In <code>:dipole</code> mode, the expected energy <span>$\langle \hat{\mathcal H}_{\mathrm{local}} \rangle$</span> must somehow be approximated using the expected dipole data.</p><p>One approach is to formally take <span>$s \to \infty$</span>, and this yields the traditional classical limit of a spin system. In this limit spin operators commute and expectation values of polynomials become polynomials of expectation values. For example, <span>$\langle \hat{S}^\alpha \hat{S}^\beta\rangle \to \langle \hat{S}^\alpha \rangle \langle \hat{S}^\beta\rangle$</span>, because any corrections are damped by the factor <span>$s^{-1} \to 0$</span>. The expectation of a Stevens operator <span>$\langle \hat{\mathcal{O}}_{k,q} \rangle$</span> would then become a classical Stevens function <span>$\mathcal{O}_{k,q}(\langle\hat{\mathbf{S}}\rangle)$</span>, i.e., a polynomial of the same form, but now applied to the expected dipole. Classical Stevens functions are constructed as homogeneous polynomials of order <span>$k$</span>, because lower-order terms would vanish in the limit <span>$s \to \infty$</span>.</p><p>For real compounds with finite quantum spin-<span>$s$</span>, one can obtain a better approximation by avoiding the formal <span>$s \to \infty$</span> limit. Corrections can be derived by starting from the full dynamics of SU(<em>N</em>) coherent states and then constraining to the space of pure dipole states <span>$|\boldsymbol{\Omega}\rangle$</span>. The latter are defined as any states where the expected dipole 3-vector,</p><p class="math-container">\[\boldsymbol{\Omega} ≡ \langle \boldsymbol{\Omega}| \hat{\mathbf{S}} | \boldsymbol{\Omega}\rangle,\]</p><p>has maximal magnitude <span>$|\boldsymbol{\Omega}| = s$</span> and arbitrary direction.</p><p>For a pure dipole state, group theory dictates that expectations of the Stevens operators can be expressed as a renormalization of the classical Stevens functions,</p><p class="math-container">\[\langle \boldsymbol{\Omega}| \hat{\mathcal{O}}_{k,q} | \boldsymbol{\Omega}\rangle = c_k \mathcal{O}_{k,q}(\boldsymbol{\Omega}).\]</p><p>At fixed <span>$k$</span>, the two sides must be proportional because they are both spin-<span>$k$</span> irreducible representations of SO(3). The renormalization factors <a href="https://arxiv.org/abs/2304.03874">can be calculated explicitly</a>:</p><p class="math-container">\[\begin{align*}
c_1 &amp;= 1 \\
c_2 &amp;= 1-\frac{1}{2}s^{-1} \\
c_3 &amp;= 1-\frac{3}{2}s^{-1}+\frac{1}{2}s^{-2} \\
c_4 &amp;= 1-3s^{-1}+\frac{11}{4}s^{-2}-\frac{3}{4}s^{-3} \\
c_5 &amp;= 1-5s^{-1}+\frac{35}{4}s^{-2}-\frac{25}{4}s^{-3}+\frac{3}{2}s^{-4} \\
c_6 &amp;= 1-\frac{15}{2}s^{-1}+\frac{85}{4}s^{-2}-\frac{225}{8}s^{-3}+\frac{137}{8}s^{-4}-\frac{15}{4}s^{-5} \\
&amp;\vdots
\end{align*}\]</p><p>Constrained to the space of dipoles, the expected local energy becomes</p><p class="math-container">\[E_{\mathrm{local}}(\boldsymbol{\Omega}) = \langle \boldsymbol{\Omega}| \hat{\mathcal H}_{\mathrm{local}} | \boldsymbol{\Omega}\rangle = \sum_{k, q} c_k A_{k,q} \mathcal{O}_{k,q}(\boldsymbol{\Omega}).\]</p><p>It can be shown that SU(<em>N</em>) dynamics reduces to the usual Landau-Lifshitz dynamics of dipoles, but involving <span>$E_{\mathrm{local}}(\boldsymbol{\Omega})$</span> as the classical Hamiltonian. The renormalization factors <span>$c_k$</span> can therefore be interpreted as a correction to the traditional large-<span>$s$</span> classical limit.</p><p>Renormalization also applies to the coupling between different sites. In Sunny, couplings will often be expressed as a polynomial of spin operators using <a href="library.html#Sunny.set_pair_coupling!"><code>set_pair_coupling!</code></a>, but any such coupling can be decomposed as a sum of tensor products of Stevens operators. Without loss of generality, consider a single coupling between two Stevens operators <span>$\hat{\mathcal{H}}_\mathrm{coupling} = \hat{\mathcal{O}}_{k,q} \otimes \hat{\mathcal{O}}_{k&#39;,q&#39;}$</span> along a bond connecting sites <span>$i$</span> and <span>$j$</span>. Upon constraining to pure dipole states <span>$|\boldsymbol{\Omega}_i\rangle$</span> and <span>$|\boldsymbol{\Omega}_j\rangle$</span>, the expected energy takes the form <span>$E_\mathrm{coupling} = c_k c_k&#39; \mathcal{O}_{k,q}(\boldsymbol{\Omega}_i) \mathcal{O}_{k&#39;,q&#39;}(\boldsymbol{\Omega}_j)$</span>, which now involves a product of renormalized Stevens functions. </p><h2 id="Use-:dipole_uncorrected-mode-to-disable-renormalization"><a class="docs-heading-anchor" href="#Use-:dipole_uncorrected-mode-to-disable-renormalization">Use <code>:dipole_uncorrected</code> mode to disable renormalization</a><a id="Use-:dipole_uncorrected-mode-to-disable-renormalization-1"></a><a class="docs-heading-anchor-permalink" href="#Use-:dipole_uncorrected-mode-to-disable-renormalization" title="Permalink"></a></h2><p>The above renormalization procedure is valid under the assumption that the starting model is the true microscopic quantum Hamiltonian. Sometimes, however, the starting model is instead an effective classical Hamiltonian that has been fitted to experimental data. In this case, the model parameters will already incorporate any appropriate renormalizations, and no further renormalization should be applied. Similarly, renormalization is unneeded for effective models of micromagnets that are far from the quantum regime.</p><p>To specify an effective spin-dipole Hamiltonian with renormalization disabled, construct a <a href="library.html#Sunny.System"><code>System</code></a> using the mode <code>:dipole_uncorrected</code> instead of <code>:dipole</code>. Formally, <code>:dipole_uncorrected</code> takes the <span>$s → ∞$</span> limit, such that all local operators become infinite dimensional and commute. A symbolic representation of these operators can be obtained by passing <code>Inf</code> to either <a href="library.html#Sunny.spin_matrices"><code>spin_matrices</code></a> or <a href="library.html#Sunny.stevens_matrices"><code>stevens_matrices</code></a>. Polynomials of such spin operators can be used, e.g., in <a href="library.html#Sunny.set_onsite_coupling!"><code>set_onsite_coupling!</code></a>.</p><h2 id="Definition-of-Stevens-operators"><a class="docs-heading-anchor" href="#Definition-of-Stevens-operators">Definition of Stevens operators</a><a id="Definition-of-Stevens-operators-1"></a><a class="docs-heading-anchor-permalink" href="#Definition-of-Stevens-operators" title="Permalink"></a></h2><p>The Stevens operators <span>$\hat{\mathcal{O}}_{k,q}$</span> are defined as polynomials of angular momentum operators <span>$\hat{S}_{\{x,y,z\}}$</span> in some spin-<span>$s$</span> representation.</p><p>Using</p><p class="math-container">\[\begin{align*}
X &amp;= \mathbf{\hat{S}} \cdot \mathbf{\hat{S}} = s (s+1) \\
\hat{S}_\pm &amp;= \hat{S}_x \pm i \hat{S}_y \\
\phi_+ &amp;= \frac{1}{4},\quad \phi_- = \frac{1}{4 i},
\end{align*}\]</p><p>the relevant Stevens operators are defined as,</p><p class="math-container">\[\begin{align*}
\hat{\mathcal{O}}_{0,0} &amp; =1\\
\\
\hat{\mathcal{O}}_{1,\pm1} &amp; =\phi_{\pm}(\hat{S}_{+}\pm\hat{S}_{-})+\mathrm{h.c.}\\
\hat{\mathcal{O}}_{1,0} &amp; =\hat{S}_{z}\\
\\
\hat{\mathcal{O}}_{2,\pm2} &amp; =\phi_{\pm}(\hat{S}_{+}^{2}\pm\hat{S}_{-}^{2})+\mathrm{h.c.}\\
\hat{\mathcal{O}}_{2,\pm1} &amp; =\phi_{\pm}(\hat{S}_{+}\pm\hat{S}_{-})\hat{S}_{z}+\mathrm{h.c.}\\
\hat{\mathcal{O}}_{2,0} &amp; =3\hat{S}_{z}^{2}-X\\
\\
\hat{\mathcal{O}}_{3,\pm3} &amp; =\phi_{\pm}(\hat{S}_{+}^{3}\pm\hat{S}_{-}^{3})+\mathrm{h.c.}\\
\hat{\mathcal{O}}_{3,\pm2} &amp; =\phi_{\pm}(\hat{S}_{+}^{2}\pm\hat{S}_{-}^{2})\hat{S}_{z}+\mathrm{h.c.}\\
\hat{\mathcal{O}}_{3,\pm1} &amp; =\phi_{\pm}(\hat{S}_{+}\pm\hat{S}_{-})(5\hat{S}_{z}^{2}-X-1/2)+\mathrm{h.c.}\\
\hat{\mathcal{O}}_{3,0} &amp; =5\hat{S}_{z}^{3}-(3X-1)\hat{S}_{z}\\
\\
\hat{\mathcal{O}}_{4,\pm4} &amp; =\phi_{\pm}(\hat{S}_{+}^{4}\pm\hat{S}_{-}^{4})+\mathrm{h.c.}\\
\hat{\mathcal{O}}_{4,\pm3} &amp; =\phi_{\pm}(\hat{S}_{+}^{3}\pm\hat{S}_{-}^{3})\hat{S}_{z}+\mathrm{h.c.}\\
\hat{\mathcal{O}}_{4,\pm2} &amp; =\phi_{\pm}(\hat{S}_{+}^{2}\pm\hat{S}_{-}^{2})(7\hat{S}_{z}^{2}-(X+5))+\mathrm{h.c.}\\
\hat{\mathcal{O}}_{4,\pm1} &amp; =\phi_{\pm}(\hat{S}_{+}\pm\hat{S}_{-})(7\hat{S}_{z}^{3}-(3X+1)\hat{S}_{z})+\mathrm{h.c.}\\
\hat{\mathcal{O}}_{4,0} &amp; =35\hat{S}_{z}^{4}-(30X-25)\hat{S}_{z}^{2}+(3X^{2}-6X)\\
\\
\hat{\mathcal{O}}_{5,\pm5} &amp; =\phi_{\pm}(\hat{S}_{+}^{5}\pm\hat{S}_{-}^{5})+\mathrm{h.c.}\\
\hat{\mathcal{O}}_{5,\pm4} &amp; =\phi_{\pm}(\hat{S}_{+}^{4}\pm\hat{S}_{-}^{4})\hat{S}_{z}+\mathrm{h.c.}\\
\hat{\mathcal{O}}_{5,\pm3} &amp; =\phi_{\pm}(\hat{S}_{+}^{3}\pm\hat{S}_{-}^{3})(9\hat{S}_{z}^{2}-(X+33/2))+\mathrm{h.c.}\\
\hat{\mathcal{O}}_{5,\pm2} &amp; =\phi_{\pm}(\hat{S}_{+}^{2}\pm\hat{S}_{-}^{2})(3\hat{S}_{z}^{3}-(X+6)\hat{S}_{z})+\mathrm{h.c.}\\
\hat{\mathcal{O}}_{5,\pm1} &amp; =\phi_{\pm}(\hat{S}_{+}\pm\hat{S}_{-})(21\hat{S}_{z}^{4}-14X\hat{S}_{z}^{2}+(X^{2}-X+3/2))+\mathrm{h.c.}\\
\hat{\mathcal{O}}_{5,0} &amp; =63\hat{S}_{z}^{5}-(70X-105)\hat{S}_{z}^{3}+(15X^{2}-50X+12)\hat{S}_{z}\\
\\
\hat{\mathcal{O}}_{6,\pm6} &amp; =\phi_{\pm}(\hat{S}_{+}^{6}\pm\hat{S}_{-}^{6})+\mathrm{h.c.}\\
\hat{\mathcal{O}}_{6,\pm5} &amp; =\phi_{\pm}(\hat{S}_{+}^{5}\pm\hat{S}_{-}^{5})\hat{S}_{z}+\mathrm{h.c.}\\
\hat{\mathcal{O}}_{6,\pm4} &amp; =\phi_{\pm}(\hat{S}_{+}^{4}\pm\hat{S}_{-}^{4})(11\hat{S}_{z}^{2}-X-38)+\mathrm{h.c.}\\
\hat{\mathcal{O}}_{6,\pm3} &amp; =\phi_{\pm}(\hat{S}_{+}^{3}\pm\hat{S}_{-}^{3})(11\hat{S}_{z}^{3}-(3X+59)\hat{S}_{z})+\mathrm{h.c.}\\
\hat{\mathcal{O}}_{6,\pm2} &amp; =\phi_{\pm}(\hat{S}_{+}^{2}\pm\hat{S}_{-}^{2})(33\hat{S}_{z}^{4}-(18X+123)\hat{S}_{z}^{2}+X^{2}+10X+102)+\mathrm{h.c.}\\
\hat{\mathcal{O}}_{6,\pm1} &amp; =\phi_{\pm}(\hat{S}_{+}\pm\hat{S}_{-})(33\hat{S}_{z}^{5}-(30X-15)\hat{S}_{z}^{3}+(5X^{2}-10X+12)\hat{S}_{z})+\mathrm{h.c.}\\
\hat{\mathcal{O}}_{6,0} &amp; =231\hat{S}_{z}^{6}-(315X-735)\hat{S}_{z}^{4}+(105X^{2}-525X+294)\hat{S}_{z}^{2}-5X^{3}+40X^{2}-60X
\end{align*}\]</p><p>Computer-generated tables of Stevens operators with <span>$k &gt; 6$</span> are available from <a href="https://doi.org/10.1088/0953-8984/16/32/018">C. Rudowicz and C. Y. Chung, J. Phys.: Condens. Matter 16, 5825 (2004)</a>, but these typically do not appear in magnetic simulations.</p><p>The case <span>$k=1$</span> gives the dipole operators,</p><p class="math-container">\[(\hat{\mathcal{O}}_{1,1}, \hat{\mathcal{O}}_{1,0}, \hat{\mathcal{O}}_{1,-1}) = (\hat{S}_{x}, \hat{S}_{z}, \hat{S}_{y}).\]</p><p>The case <span>$k=2$</span> gives the quadrupole operators,</p><p class="math-container">\[(\hat{\mathcal{O}}_{2,2}, \dots, \hat{\mathcal{O}}_{2,-2}) = \left(\hat{S}_x^2 - \hat{S}_y^2, \frac{\hat{S}_x \hat{S}_z + \hat{S}_z \hat{S}_x}{2}, 2\hat{S}_z^2-\hat{S}_x^2-\hat{S}_y^2, \frac{\hat{S}_y \hat{S}_z + \hat{S}_z \hat{S}_y}{2}, \hat{S}_x \hat{S}_y + \hat{S}_y \hat{S}_x\right).\]</p><p>For each <span>$k$</span> value, the set of operators <span>$\hat{\mathcal{O}}_{k,q&#39;}$</span> for <span>$q&#39; = -k, \dots, k$</span> form an irreducible representation of the group of rotations O(3). That is, rotation will transform <span>$\hat{\mathcal{O}}_{k,q}$</span> into a linear combination of <span>$\hat{\mathcal{O}}_{k,q&#39;}$</span> where <span>$q&#39;$</span> varies but <span>$k$</span> remains fixed. </p><p>In taking the large-<span>$s$</span> limit, each dipole operator is replaced by its expectation value <span>$\boldsymbol{\Omega} = \langle \hat{\mathbf{S}} \rangle$</span>, and only leading-order terms are retained. The operator <span>$\hat{\mathcal{O}}_{k,q}$</span> becomes a homogeneous polynomial <span>$O_{k,q}(\boldsymbol{\Omega})$</span> of order <span>$k$</span> in the spin components <span>$\Omega^\alpha$</span>. One can see these polynomials by constructing <a href="library.html#Sunny.stevens_matrices"><code>stevens_matrices</code></a> with the argument <code>s = Inf</code>. Due to the normalization constraint, each dipole can be expressed in polar angles, <span>$(\theta, \phi)$</span>. Then the Stevens functions <span>$O_{k,q}(\boldsymbol{\Omega})$</span> correspond to the spherical harmonic functions <span>$Y_l^m(\theta, \phi)$</span> where <span>$l=k$</span> and <span>$m=q$</span>; this correspondence is valid up to <span>$k$</span> and <span>$q$</span>-dependent rescaling factors.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="structure-factor.html">« Structure Factor Conventions</a><a class="docs-footer-nextpage" href="parallelism.html">Parallelizing Calculations »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Friday 6 December 2024 22:31">Friday 6 December 2024</span>. Using Julia version 1.10.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
