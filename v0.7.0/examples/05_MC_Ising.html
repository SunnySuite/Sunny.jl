<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>5. Monte Carlo sampling of the Ising model ¬∑ Sunny documentation</title><meta name="title" content="5. Monte Carlo sampling of the Ising model ¬∑ Sunny documentation"/><meta property="og:title" content="5. Monte Carlo sampling of the Ising model ¬∑ Sunny documentation"/><meta property="twitter:title" content="5. Monte Carlo sampling of the Ising model ¬∑ Sunny documentation"/><meta name="description" content="Documentation for Sunny documentation."/><meta property="og:description" content="Documentation for Sunny documentation."/><meta property="twitter:description" content="Documentation for Sunny documentation."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../index.html"><img class="docs-light-only" src="../assets/logo.svg" alt="Sunny documentation logo"/><img class="docs-dark-only" src="../assets/logo-dark.svg" alt="Sunny documentation logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../index.html">Sunny documentation</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../index.html">Overview</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="01_LSWT_CoRh2O4.html">1. Spin wave simulations of CoRh‚ÇÇO‚ÇÑ</a></li><li><a class="tocitem" href="02_LLD_CoRh2O4.html">2. Landau-Lifshitz dynamics of CoRh‚ÇÇO‚ÇÑ at finite <em>T</em></a></li><li><a class="tocitem" href="03_LSWT_SU3_FeI2.html">3. Multi-flavor spin wave simulations of FeI‚ÇÇ</a></li><li><a class="tocitem" href="04_GSD_FeI2.html">4. Generalized spin dynamics of FeI‚ÇÇ at finite <em>T</em></a></li><li class="is-active"><a class="tocitem" href="05_MC_Ising.html">5. Monte Carlo sampling of the Ising model</a></li><li><a class="tocitem" href="06_CP2_Skyrmions.html">6. Dynamical quench into CP¬≤ skyrmion liquid</a></li><li><a class="tocitem" href="07_Dipole_Dipole.html">7. Long-range dipole interactions</a></li><li><a class="tocitem" href="08_Momentum_Conventions.html">8. Momentum transfer conventions</a></li><li><input class="collapse-toggle" id="menuitem-2-9" type="checkbox"/><label class="tocitem" for="menuitem-2-9"><span class="docs-label">SpinW ports</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="spinw/SW01_FM_Heseinberg_chain.html">SW01 - FM Heisenberg chain</a></li><li><a class="tocitem" href="spinw/SW02_AFM_Heisenberg_chain.html">SW02 - AFM Heisenberg chain</a></li><li><a class="tocitem" href="spinw/SW03_Frustrated_chain.html">SW03 - Frustrated J1-J2 chain</a></li><li><a class="tocitem" href="spinw/SW04_Frustrated_square.html">SW04 - Frustrated square lattice</a></li><li><a class="tocitem" href="spinw/SW05_Simple_kagome_FM.html">SW05 - Simple kagome ferromagnet</a></li><li><a class="tocitem" href="spinw/SW06_Complex_kagome_FM.html">SW06 - Complex kagome ferromagnet</a></li><li><a class="tocitem" href="spinw/SW07_k0_kagome_AFM.html">SW07 - k=0 kagome antiferromagnet</a></li><li><a class="tocitem" href="spinw/SW08_sqrt3_kagome_AFM.html">SW08 - ‚àö3√ó‚àö3 kagome antiferromagnet</a></li><li><a class="tocitem" href="spinw/SW09_k0_kagome_AFM_DM.html">SW09 - k=0 kagome AFM and DM</a></li><li><a class="tocitem" href="spinw/SW10_Energy_cut.html">SW10 - Energy cut on square lattice</a></li><li><a class="tocitem" href="spinw/SW11_La2CuO4.html">SW11 - La‚ÇÇCuO‚ÇÑ</a></li><li><a class="tocitem" href="spinw/SW12_Triangular_easy_plane.html">SW12 - Triangular lattice with easy plane</a></li><li><a class="tocitem" href="spinw/SW13_LiNiPO4.html">SW13 - LiNiPO‚ÇÑ</a></li><li><a class="tocitem" href="spinw/SW14_YVO3.html">SW14 - YVO‚ÇÉ</a></li><li><a class="tocitem" href="spinw/SW15_Ba3NbFe3Si2O14.html">SW15 - Ba‚ÇÉNbFe‚ÇÉSi‚ÇÇO‚ÇÅ‚ÇÑ</a></li><li><a class="tocitem" href="spinw/SW18_Distorted_kagome.html">SW18 - Distorted kagome</a></li><li><a class="tocitem" href="spinw/SW19_Different_Ions.html">SW19 - Different magnetic ions</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-10" type="checkbox"/><label class="tocitem" for="menuitem-2-10"><span class="docs-label">Contributed</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="contributed/MgCr2O4-tutorial.html">MgCr2O4 at Finite Temperature</a></li><li><a class="tocitem" href="contributed/kappa_tutorial.html">Enforcing the quantum sum rule with moment renormalization</a></li></ul></li></ul></li><li><span class="tocitem">Guides</span><ul><li><a class="tocitem" href="../structure-factor.html">Structure Factor Conventions</a></li><li><a class="tocitem" href="../parallelism.html">Parallelizing Calculations</a></li><li><a class="tocitem" href="../renormalization.html">Interaction Renormalization</a></li></ul></li><li><a class="tocitem" href="../library.html">Library API</a></li><li><a class="tocitem" href="../versions.html">Version History</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="05_MC_Ising.html">5. Monte Carlo sampling of the Ising model</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="05_MC_Ising.html">5. Monte Carlo sampling of the Ising model</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SunnySuite/Sunny.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands">ÔÇõ</span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SunnySuite/Sunny.jl/blob/main/examples/05_MC_Ising.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid">ÔÅÑ</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><p>Download this example as <a href="../assets/scripts/05_MC_Ising.jl">Julia file</a> or <a href="../assets/notebooks/05_MC_Ising.ipynb">Jupyter notebook</a>.</p><h1 id="5.-Monte-Carlo-sampling-of-the-Ising-model"><a class="docs-heading-anchor" href="#5.-Monte-Carlo-sampling-of-the-Ising-model">5. Monte Carlo sampling of the Ising model</a><a id="5.-Monte-Carlo-sampling-of-the-Ising-model-1"></a><a class="docs-heading-anchor-permalink" href="#5.-Monte-Carlo-sampling-of-the-Ising-model" title="Permalink"></a></h1><p>This tutorial illustrates simulation of the classical 2D Ising model.</p><pre><code class="language-julia hljs">using Sunny, GLMakie</code></pre><p>To model the 2D square lattice, create an elongated tetragonal cell with one atom.</p><pre><code class="language-julia hljs">latvecs = lattice_vectors(1, 1, 10, 90, 90, 90)
crystal = Crystal(latvecs, [[0, 0, 0]])</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi"><span class="sgr4"><span class="sgr1">Crystal</span></span>
Spacegroup &#39;P 4/m m m&#39; (123)
Lattice params a=1, b=1, c=10, Œ±=90¬∞, Œ≤=90¬∞, Œ≥=90¬∞
Cell volume 10
Wyckoff 1a (point group &#39;4/mmm&#39;):
   1. [0, 0, 0]
</code></pre><p>Create a <a href="../library.html#Sunny.System-Tuple{Crystal, Vector{Pair{Int64, Moment}}, Symbol}"><code>System</code></a> of spin dipoles. Following the Ising convention, we will restrict the dipoles to <span>$¬±1$</span> along the global <span>$\hat{z}$</span>-axis. Select <span>$g=-1$</span> so that the Zeeman coupling between external field <span>$ùêÅ$</span> and spin dipole <span>$ùê¨$</span> is <span>$-ùêÅ‚ãÖùê¨$</span>. The system size is 128√ó128.</p><pre><code class="language-julia hljs">L = 128
sys = System(crystal, [1 =&gt; Moment(s=1, g=-1)], :dipole; dims=(L, L, 1), seed=0)
polarize_spins!(sys, (0, 0, 1))</code></pre><p>Use <a href="../library.html#Sunny.set_exchange!-Union{Tuple{N}, Tuple{System{N}, Any, Bond}} where N"><code>set_exchange!</code></a> to include a ferromagnetic Heisenberg interaction along nearest-neighbor bonds. The <a href="../library.html#Sunny.Bond"><code>Bond</code></a> below connects two spins displaced by the lattice vector <span>$ùêö‚ÇÅ$</span>. This interaction will be propagated to all nearest-neighbors bonds in the system, consistent with the symmetries of the square lattice.</p><pre><code class="language-julia hljs">set_exchange!(sys, -1.0, Bond(1, 1, (1, 0, 0)))</code></pre><p>If an external field is desired, it can be set using <a href="../library.html#Sunny.set_field!-Tuple{System, Any}"><code>set_field!</code></a>.</p><pre><code class="language-julia hljs">B = 0
set_field!(sys, (0, 0, B))</code></pre><p>The critical temperature for the Ising model is known analytically.</p><pre><code class="language-julia hljs">Tc = 2/log(1+‚àö2)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2.269185314213022</code></pre><p>Use a <a href="../library.html#Sunny.LocalSampler"><code>LocalSampler</code></a> to perform <code>nsweeps</code> Monte Carlo sweeps. A sweep consists of, on average, one trial update per spin in the system. Each proposed update is accepted or rejected according to the Metropolis acceptance probability. As its name suggests, the <a href="../library.html#Sunny.propose_flip-Union{Tuple{N}, Tuple{System{N}, Any}} where N"><code>propose_flip</code></a> function will only propose pure spin flips, <span>$ùê¨ \rightarrow -ùê¨$</span>.</p><pre><code class="language-julia hljs">nsweeps = 4000
sampler = LocalSampler(kT=Tc, propose=propose_flip)
for i in 1:nsweeps
    step!(sys, sampler)
end</code></pre><p>Plot the Ising spins by extracting the <span>$z$</span>-component of the dipoles</p><pre><code class="language-julia hljs">heatmap(reshape([S[3] for S in sys.dipoles], (L, L)))</code></pre><img src="05_MC_Ising-b914bbdb.png" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="04_GSD_FeI2.html">¬´ 4. Generalized spin dynamics of FeI‚ÇÇ at finite <em>T</em></a><a class="docs-footer-nextpage" href="06_CP2_Skyrmions.html">6. Dynamical quench into CP¬≤ skyrmion liquid ¬ª</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.6.0 on <span class="colophon-date" title="Friday 30 August 2024 23:40">Friday 30 August 2024</span>. Using Julia version 1.10.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
