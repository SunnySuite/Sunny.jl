<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>ParaView Rendering · Sunny documentation</title><meta name="title" content="ParaView Rendering · Sunny documentation"/><meta property="og:title" content="ParaView Rendering · Sunny documentation"/><meta property="twitter:title" content="ParaView Rendering · Sunny documentation"/><meta name="description" content="Documentation for Sunny documentation."/><meta property="og:description" content="Documentation for Sunny documentation."/><meta property="twitter:description" content="Documentation for Sunny documentation."/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="index.html"><img class="docs-light-only" src="assets/logo.svg" alt="Sunny documentation logo"/><img class="docs-dark-only" src="assets/logo-dark.svg" alt="Sunny documentation logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="index.html">Sunny documentation</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="index.html">Overview</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="examples/01_LSWT_CoRh2O4.html">1. Spin wave simulations of CoRh₂O₄</a></li><li><a class="tocitem" href="examples/02_LLD_CoRh2O4.html">2. Landau-Lifshitz dynamics of CoRh₂O₄ at finite <em>T</em></a></li><li><a class="tocitem" href="examples/03_LSWT_SU3_FeI2.html">3. Multi-flavor spin wave simulations of FeI₂</a></li><li><a class="tocitem" href="examples/04_GSD_FeI2.html">4. Generalized spin dynamics of FeI₂ at finite <em>T</em></a></li><li><a class="tocitem" href="examples/05_MC_Ising.html">5. Monte Carlo sampling of the Ising model</a></li><li><a class="tocitem" href="examples/06_CP2_Skyrmions.html">6. Dynamical quench into CP² skyrmion liquid</a></li><li><a class="tocitem" href="examples/07_Dipole_Dipole.html">7. Long-range dipole interactions</a></li><li><a class="tocitem" href="examples/08_Momentum_Conventions.html">8. Momentum transfer conventions</a></li><li><a class="tocitem" href="examples/09_Disorder_KPM.html">9. Disordered system with KPM</a></li><li><input class="collapse-toggle" id="menuitem-2-10" type="checkbox"/><label class="tocitem" for="menuitem-2-10"><span class="docs-label">SpinW ports</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="examples/spinw/SW01_FM_Heseinberg_chain.html">SW01 - FM Heisenberg chain</a></li><li><a class="tocitem" href="examples/spinw/SW02_AFM_Heisenberg_chain.html">SW02 - AFM Heisenberg chain</a></li><li><a class="tocitem" href="examples/spinw/SW03_Frustrated_chain.html">SW03 - Frustrated J1-J2 chain</a></li><li><a class="tocitem" href="examples/spinw/SW04_Frustrated_square.html">SW04 - Frustrated square lattice</a></li><li><a class="tocitem" href="examples/spinw/SW05_Simple_kagome_FM.html">SW05 - Simple kagome ferromagnet</a></li><li><a class="tocitem" href="examples/spinw/SW06_Complex_kagome_FM.html">SW06 - Complex kagome ferromagnet</a></li><li><a class="tocitem" href="examples/spinw/SW07_k0_kagome_AFM.html">SW07 - k=0 kagome antiferromagnet</a></li><li><a class="tocitem" href="examples/spinw/SW08_sqrt3_kagome_AFM.html">SW08 - √3×√3 kagome antiferromagnet</a></li><li><a class="tocitem" href="examples/spinw/SW09_k0_kagome_AFM_DM.html">SW09 - k=0 kagome AFM and DM</a></li><li><a class="tocitem" href="examples/spinw/SW10_Energy_cut.html">SW10 - Energy cut on square lattice</a></li><li><a class="tocitem" href="examples/spinw/SW11_La2CuO4.html">SW11 - La₂CuO₄</a></li><li><a class="tocitem" href="examples/spinw/SW12_Triangular_easy_plane.html">SW12 - Triangular lattice with easy plane</a></li><li><a class="tocitem" href="examples/spinw/SW13_LiNiPO4.html">SW13 - LiNiPO₄</a></li><li><a class="tocitem" href="examples/spinw/SW14_YVO3.html">SW14 - YVO₃</a></li><li><a class="tocitem" href="examples/spinw/SW15_Ba3NbFe3Si2O14.html">SW15 - Ba₃NbFe₃Si₂O₁₄</a></li><li><a class="tocitem" href="examples/spinw/SW18_Distorted_kagome.html">SW18 - Distorted kagome</a></li><li><a class="tocitem" href="examples/spinw/SW19_Different_Ions.html">SW19 - Different magnetic ions</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-11" type="checkbox"/><label class="tocitem" for="menuitem-2-11"><span class="docs-label">Contributed</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="examples/contributed/MgCr2O4-tutorial.html">MgCr2O4 at Finite Temperature</a></li><li><a class="tocitem" href="examples/contributed/kappa_tutorial.html">Enforcing the quantum sum rule with moment renormalization</a></li></ul></li></ul></li><li><span class="tocitem">Guides</span><ul><li><a class="tocitem" href="structure-factor.html">Structure Factor Conventions</a></li><li><a class="tocitem" href="parallelism.html">Parallelizing Calculations</a></li><li><a class="tocitem" href="renormalization.html">Interaction Renormalization</a></li></ul></li><li><a class="tocitem" href="library.html">Library API</a></li><li><a class="tocitem" href="versions.html">Version History</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href="writevtk.html">ParaView Rendering</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="writevtk.html">ParaView Rendering</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SunnySuite/Sunny.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SunnySuite/Sunny.jl/blob/main/docs/src/writevtk.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="ParaView-Rendering"><a class="docs-heading-anchor" href="#ParaView-Rendering">ParaView Rendering</a><a id="ParaView-Rendering-1"></a><a class="docs-heading-anchor-permalink" href="#ParaView-Rendering" title="Permalink"></a></h1><p>The 4D correlation data produced by Sunny is too high-dimensional to visualize directly. This page describes how to export <em>3D slices</em> of correlation data from Sunny to the Visual ToolKit (VTK) format, which is compatible with the <a href="https://www.paraview.org/">ParaView</a> visualization software. ParaView supports volumetric rendering:</p><img src="./assets/paraviewrender.jpg" style="margin: 30px; " width="400"><h2 id="Simulation-data"><a class="docs-heading-anchor" href="#Simulation-data">Simulation data</a><a id="Simulation-data-1"></a><a class="docs-heading-anchor-permalink" href="#Simulation-data" title="Permalink"></a></h2><p>First, generate some correlation data in Sunny. We will use a 2D lattice, since the correlation data <span>$S(Q_x,Q_y,\omega)$</span> is 3D and can be exported in its entirety. The following code sets up the system, thermalizes it, and records the correlation data in a <code>SampledCorrelations</code> called <code>dsf</code>.</p><pre><code class="language-julia hljs">using Sunny

latvecs = lattice_vectors(8.,8.,12.,90,100,90)
positions = [[0,0,0]]
types = [&quot;Cu&quot;]
formfactors = [FormFactor(&quot;Cu2&quot;)]
xtal = Crystal(latvecs, positions; types)

sys = System(xtal, [1 =&gt; Moment(s=1/2, g=2)], :SUN; dims=(12, 12, 1), seed=1)

J = 10.
set_exchange!(sys, J, Bond(1,1,[1,0,0]))
set_exchange!(sys, J, Bond(1,1,[0,1,0]))

dt = 0.01
kT = 0.5
langevin = Langevin(dt; damping=0.5, kT)
randomize_spins!(sys)
for i in 1:10_000 # Long enough to reach equilibrium
    step!(sys, langevin)
end 

ωmax=10.
dsf = SampledCorrelations(sys; dt, energies=range(0, ωmax, 48))

nsamples = 10
for _ in 1:nsamples
    for _ in 1:1000 
        step!(sys, langevin)
    end
    add_sample!(dsf, sys)
end</code></pre><p>The default histogram <a href="library.html#Sunny.BinningParameters"><code>BinningParameters</code></a> are already integrated over the <span>$z$</span> direction because the system is 2D:</p><pre><code class="language-julia hljs">unit_resolution_binning_parameters(dsf)</code></pre><pre><code class="nohighlight hljs">⊡    12 bins from -0.042 to +0.958 along [+1.27 dx] (Δ = 0.065)
⊡    12 bins from -0.042 to +0.958 along [+1.27 dy] (Δ = 0.065)
∫ Integrated from +0.000 to +0.000 along [-0.33 dx +1.88 dz] (Δ = 0.524)
⊡    48 bins from -0.107 to +10.134 along [+1.00 dE] (Δ = 0.213)</code></pre><p>The histogram is very oblong; it&#39;s approximately <code>1x1x10</code>. To make it a nicer shape, we will rescale the energy axis to be be fractions of <code>ωmax</code>:</p><pre><code class="language-julia hljs">params = unit_resolution_binning_parameters(dsf)
scale_factor = ωmax
params.binend[4] /= scale_factor
params.binstart[4] /= scale_factor
params.binwidth[4] /= scale_factor
params.covectors[4,:] ./= scale_factor</code></pre><p>Doing this changes the last axis of the histogram to fit in [0,1]:</p><pre><code class="nohighlight hljs">⊡    49 bins from -0.011 to +1.013 along [+0.10 dE] (Δ = 0.213)</code></pre><p>Now that our histogram is a cube, we compute the intensity in the histogram bins using the usual <code>intensities_binned</code>:</p><pre><code class="language-julia hljs">formula = intensity_formula(dsf, :trace)
signal, counts = intensities_binned(dsf, params; formula)
intensity = signal ./ counts</code></pre><p>Now that we have our intensity data and the binning parameters, we can export to VTK format using <a href="library.html#Sunny.export_vtk"><code>export_vtk</code></a> and move to ParaView for the visualization.</p><pre><code class="language-julia hljs"># Importing WriteVTK enables Sunny&#39;s export-to-VTK functions
import WriteVTK

# [1,2,4] specifies that the (x,y,z) axes in ParaView are (Qx,Qy,ω)
export_vtk(&quot;square_lattice&quot;, params, intensity; dims_kept = [1,2,4])
# Writes a file square_lattice.vti in the current directory</code></pre><h3 id="Loading-in-ParaView"><a class="docs-heading-anchor" href="#Loading-in-ParaView">Loading in ParaView</a><a id="Loading-in-ParaView-1"></a><a class="docs-heading-anchor-permalink" href="#Loading-in-ParaView" title="Permalink"></a></h3><p>In ParaView, use <code>File &gt; Open</code> to open <code>square_lattice.vti</code>. This will add the file to the Pipeline Browser with a closed eye icon, indicating that the data is ready to be loaded.</p><p>In the Properties panel, both <code>bin_centers</code> and <code>data</code> will be selected for import by default. Uncheck <code>bin_centers</code> because we don&#39;t need that information for the visualization. Click the green Apply button to load the data.</p><p>By default, only the outline of the data is shown in the 3D viewport. Since we adjusted the energy axis, the outline is a 1x1x1 cube. Optionally enable the axes grid under &quot;View&quot;, and customize using the adjacent edit button.</p><img src="./assets/paraviewimport.png" style="margin: 30px;" width="200"><p><strong>To enable the volumetric render</strong>:</p><ol><li>Select &quot;Volume&quot; from the &quot;Representation&quot; drop-down menu under &quot;Display&quot;.</li><li>The &quot;Coloring&quot; drop-down should automatically select <code>data</code> because it&#39;s the only data loaded.</li><li>Open the Color Map Editor to adjust the opacity of the fog, which may be too faint to see by default.</li></ol><img src="./assets/paraviewvolume.png" style="margin: 30px; " width="400"><p>Depending on your computer and your dataset size, the volumetric rendering may be slow, but our dataset is relatively small, so the render should be fast.</p><p>If nothing shows up at first, don&#39;t despair. Often, there are Bragg-like peaks in the correlation data which outshine everything else. To see this, enable Display Data Histogram in the Color Map Editor panel. To zoom in on the lower-intensity data, click and drag the right side handle of the opacity transfer function box to the middle a few times.</p><img src="./assets/paraviewcolormap.png" style="margin: 30px; " width="200"><p>After suitable color mapping, the dispersion curve should become visible:</p><img src="./assets/paraviewrender.jpg" style="margin: 30px; " width="400"><h2 id="Experiment-data"><a class="docs-heading-anchor" href="#Experiment-data">Experiment data</a><a id="Experiment-data-1"></a><a class="docs-heading-anchor-permalink" href="#Experiment-data" title="Permalink"></a></h2><p>Note that since only the data and binning parameters are required for exporting to VTK, experiment data can be exported in the same way. For example, to visualize <span>$S(Q_x,Q_y,Q_z)$</span>, do this:</p><pre><code class="language-julia hljs"># Load 4D histogram data from Mantid
params, signal = load_nxs(&quot;experiment_data.nxs&quot;)

# Integrate out the energy axis so we are 3D
integrate_axes!(params; axes = 4)
signal = sum(signal; dims = 4)

# Export to ParaView
export_vtk(&quot;experiment_data_as_vtk&quot;, params, signal)</code></pre></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Tuesday 12 November 2024 15:12">Tuesday 12 November 2024</span>. Using Julia version 1.10.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
